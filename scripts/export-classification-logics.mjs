import fs from 'fs';
import path from 'path';
import XLSX from 'xlsx';

const autoRules = [
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'professional | service | services',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Sale of services',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'scrap',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Scrap sales',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'export',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Export incentives',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'grant',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Government grants',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'commission',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Commission income',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'rent | rental',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Rental Income',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'royalty',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Royalty income',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'know how',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Technical know how fees',
    Notes: 'Ledger keyword phrase match',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'insurance',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Insurance claims',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'misc',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Miscellaneous receipts',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Sale of products',
    Notes: 'Default',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Tax refunds',
    Notes: 'Also needs keywords: income tax | tax refund | tax',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Bank deposits',
    Notes: 'Also needs keywords: bank | fd | fixed deposit | fixeddeposit',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Non-current Investments',
    Notes: 'Also needs keywords: non-current investment',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Current Investments',
    Notes: 'Also needs keywords: current investment',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Advances and Deposits',
    Notes: 'Also needs keywords: advance | advances | deposit | deposits',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Loans',
    Notes: 'Also needs keywords: loan | loans',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'dividend',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Dividend income on Non-current Investments',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'forex | foreign + gain | loss',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Gain on Foreign Exchange fluctuations (Net)',
    Notes: 'Requires both sets of keywords',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'sale + fixed asset | plant | property',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Gain on Foreign Exchange fluctuations (Net)',
    Notes: 'Requires both sale + asset keywords',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'written back | written off',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Provisions written back',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Miscellaneous non-operating Income',
    Notes: 'Default',
  },
  {
    Section: 'Purchase Accounts',
    GroupMatch: 'Purchase Accounts',
    LedgerKeywords: '',
    BusinessType: 'Trading',
    H1: 'Expense',
    H2: 'Purchases of Stock in Trade',
    H3: 'Purchases of Stock in Trade',
    Notes: '',
  },
  {
    Section: 'Purchase Accounts',
    GroupMatch: 'Purchase Accounts',
    LedgerKeywords: '',
    BusinessType: 'Non-Trading',
    H1: 'Expense',
    H2: 'Cost of Materials Consumed',
    H3: 'Purchase of Raw Materials',
    Notes: '',
  },
  {
    Section: 'Stock-in-Hand',
    GroupMatch: 'Stock-in-Hand',
    LedgerKeywords: '',
    BusinessType: 'Trading',
    H1: 'Expense',
    H2: 'Change in Inventories',
    H3: 'Change in Inventories',
    Notes: '',
  },
  {
    Section: 'Direct Expenses',
    GroupMatch: 'Direct Expenses (and not Indirect Expenses)',
    LedgerKeywords: '',
    BusinessType: 'Trading',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: '(keep current H3)',
    Notes: '',
  },
  {
    Section: 'Direct Expenses',
    GroupMatch: 'Direct Expenses (and not Indirect Expenses)',
    LedgerKeywords: '',
    BusinessType: 'Non-Trading',
    H1: 'Expense',
    H2: 'Cost of Materials Consumed',
    H3: 'Other Direct expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int + bank | loan | cash credit | cc | overdraft | od',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Interest expense on Borrowings',
    Notes: 'Requires interest + borrowing keywords',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int + gst | income tax | tds | tax',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Interest expense on late payment of taxes',
    Notes: 'Requires interest + tax keywords',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int + partner | capital | owner',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: "Interest on Partners' or Owners' Capital",
    Notes: 'Requires interest + partner/capital keywords',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Interest expense others',
    Notes: 'Default interest',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bank charge | renewal charge | processing charge | bg commission',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Other Borrowing costs',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'amortisation | amortization | amorti',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Depreciation and Amortisation Expense',
    H3: 'Amortisation of Intangible Assets',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'depreciation | depn',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Depreciation and Amortisation Expense',
    H3: 'Depreciation on Property, Plant and Equipment',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'remuneration',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: "Partners' Remuneration",
    H3: "Partners' Remuneration",
    Notes: 'Only for Partnership / LLP',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'employee',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Salaries and wages',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'salary | salaries | wages | wage | stipend',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Salaries and wages',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'director + remuneration',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: "Directors' Remuneration",
    Notes: 'Only for Private/Public/OPC',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'esi',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Contribution to provident and other funds',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'pf | provident | esic | employee state | gratuity',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Contribution to provident and other funds',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'income tax | tax + current | current year',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Tax Expenses',
    H3: 'Income Tax - Current Year',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'deferred tax | deferred',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Tax Expenses',
    H3: 'Deferred Tax - Origination and reversal of Timing differences',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'mat',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Tax Expenses',
    H3: 'Income Tax - Less: MAT Credit Entitlement',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'adver | marketing',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Advertisement and Marketing',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'audit',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: "Auditor's Remuneration",
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bad debt | write off | written off',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Bad Debts written off',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bad loan | bad adva | bad adv',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Bad Loans and Advances written off',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bank chg | bank charge',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Bank Charges',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'commission | brokerage',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Commission and Brokerage',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'stores | spares | parts',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Stores and spare parts - Purchase',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'conveyance | local travel',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Conveyance expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'csr | corporate social',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Corporate social responsibility expense',
    Notes: 'Only for Private/Public/OPC',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'design | product | development',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Design and product development',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'director sitting fees | director commission',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: "Directors' fees and commission",
    Notes: 'Only for Private/Public/OPC',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'donation | charity',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Donations and charity',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'electricity | power | fuel | diesel | petrol',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Electricity, Power and fuel',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'freight | carriage | forwarding | transport',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Freight and forwarding',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'information | technology | software',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Information technology services',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'insurance | life | health | key man',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Insurance expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'office | admin',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Office and Administration',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'print | stationery | stationary',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Printing and stationery',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'professional | consultancy | retainer',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Professional and consultancy charges',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision + debt',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Doubtful Debts',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision + loan | advance',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Doubtful Loans and Advances',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision + warran',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Warranties',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Other Expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'rates | taxes | professional tax | ptax | trade licence | municipal tax | late fee',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Rates and Taxes',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'recruitment | training',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Recruitment and training charges',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'rent',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Rent expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'repair | r&m + building | office | factory',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Repairs to buildings',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'repair | r&m + plant | machinery | p&m',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Repairs to machinery',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'repair | r&m',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Repairs and maintenance',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'royalty',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Royalty expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'security | housekeeping',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Security and Housekeeping',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'selling | distribution',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Selling and Distribution expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'telephone | mobile | internet',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Telephone and Internet',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'travel',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Travelling expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Miscellaneous other expenses',
    Notes: 'Default',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'freehold land | land freehold | owned land | plot | land asset | land property',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Freehold Land',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'leasehold land | land leasehold | leased land | land on lease | long term lease land',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Leasehold Land',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'leasehold improvement | lease improvement | lease renovation | lease fit out | lease interior | tenant improvement',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Leasehold Improvement',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'office building | factory building | warehouse | godown | commercial building | civil construction | structure | building',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Buildings',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'production machinery | manufacturing equipment | tools and machinery | equipment industrial | machinery | machine | plant',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Plant and Machinery',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'office furniture | furniture | fixtures | desk | table | chair | workstation | cabinet | cupboard | rack | shelf',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Furniture and Fixtures',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'electrical installation | electrical fitting | wiring | cabling | switchboard | panel board | transformer | generator | dg set | power installation',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Electrical Installations',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'office equipment | printer | scanner | photocopier | copier machine | xerox | projector | shredder | laminator | biometric machine | attendance machine',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Office Equipment',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'computer | desktop | laptop | notebook | server | workstation | cpu | monitor | ups | router | switch | networking equipment',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Computers',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'commercial vehicle | vehicle | car | truck | lorry | van | bus | two wheeler | scooter | bike',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Vehicles',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - PPE',
    GroupMatch: 'Fixed Assets | PPE | Property Plant and Equipment | Property Plant & Equipment',
    LedgerKeywords: 'capital work in progress | cwip | capital wip | asset under construction | project under construction | work in progress capital | incomplete asset',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Capital Work-in-Progress (CWIP)',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'goodwill | business goodwill | purchased goodwill | goodwill asset',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Goodwill',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'goodwill on consolidation | consolidation goodwill | goodwill arising on merger | merger goodwill | amalgamation goodwill | acquisition goodwill',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Goodwill on Consolidation',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'computer software | application software | system software | accounting software | licensed software | software license | software | erp | saas',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Computer Software',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'trademark | trade mark | brand | brand name | logo | brand rights | trademark rights | brand license',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Trademarks and Brands',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'technical knowhow | technical know-how | knowhow | process knowhow | manufacturing knowhow | technology knowhow | technical collaboration',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Technical Knowhow',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'intangible under development | intangible wip | cwip intangible | capital work in progress intangible | software under development | development cost intangible',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Intangible Assets under Development',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Fixed Assets - Intangible',
    GroupMatch: 'Fixed Assets | Intangible | Goodwill | Software',
    LedgerKeywords: 'intangible asset | intangible assets others | intellectual property | ip rights | business rights | commercial rights | franchise rights | license rights',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Property, Plant and Equipment',
    H3: 'Gross Block - Others (Intangible)',
    Notes: 'Ledger/Parent keyword match (whole words)',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Cash-in-Hand',
    LedgerKeywords: 'cash',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Cash on hand',
    Notes: 'Primary Group Cash-in-Hand + cash keyword',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'eefc | exchange earners foreign currency',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'EEFC Account',
    Notes: 'Priority: EEFC',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'margin money | margin | lien | lien marked',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Bank balances held as margin money',
    Notes: 'Priority: margin money',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'security | secured | collateral | against borrowing | against loan | loan security',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Bank balances held as security against borrowings',
    Notes: 'Priority: security against borrowings',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'cheque | draft | dd',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Cheques, drafts on hand',
    Notes: 'Priority: cheques/drafts',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'fd | fdr | fixed deposit | term deposit | td | deposit + 3 months | 90 days | upto 3 months | short term | st',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Bank deposits with upto three months maturity',
    Notes: 'Priority: deposits <= 3 months',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'fd | fdr | fixed deposit | term deposit | td | deposit + 12 months | 365 days | 1 year | upto 12 months',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Bank deposits with upto twelve months maturity',
    Notes: 'Priority: deposits <= 12 months',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'saving | sb',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Balances with banks in savings accounts',
    Notes: 'Priority: savings',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: 'current | ca | bank',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Balances with banks in current accounts',
    Notes: 'Priority: current',
  },
  {
    Section: 'Cash and Bank Balances',
    GroupMatch: 'Bank Accounts',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Cash and Bank Balances',
    H3: 'Other bank balances',
    Notes: 'Default bank accounts',
  },
  {
    Section: 'Trade Receivables',
    GroupMatch: 'Sundry Debtors | Trade Receivables | Accounts Receivable | Customer/Debtor group',
    LedgerKeywords: 'sundry debtor | sundry debtors | trade receivable | trade receivables | accounts receivable | account receivable | debtors | customer receivable | customer balance | outstanding receivable | sales receivable | invoice receivable | fees receivable | service receivable | consultancy receivable | professional fees receivable | amc receivable | maintenance receivable | subscription receivable | project billing receivable | flat buyer receivable | flat buyers balance | booking receivable | installment receivable | possession receivable | rent receivable | lease rental receivable | maintenance charges receivable | export receivable | domestic receivable | dealer receivable | distributor receivable | license fee receivable | software service receivable | development charges receivable | freight receivable | transport charges receivable | logistics receivable | patient receivable | hospital charges receivable | tuition fees receivable | student fees receivable',
    BusinessType: 'Any',
    H1: 'Asset',
    H2: 'Trade Receivables',
    H3: 'Unsecured, considered good',
    Notes: 'Exclude: advance | prepaid | loan | deposit | security deposit | staff advance',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'capital reserve',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Capital Reserve',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'securities premium | premium',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Securities Premium',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'capital redemption',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Capital Redemption Reserve',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'debenture',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Debenture Redemption Reserve',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'revaluation',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Revaluation Reserve',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'share option',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Share Option Outstanding Account',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: 'general',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'General Reserve',
    Notes: 'Overrides H1 to Liability',
  },
  {
    Section: 'Capital Account - Reserves and Surplus',
    GroupMatch: 'Capital Account + Reserves and Surplus',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Surplus in Statement of Profit and Loss',
    Notes: 'Default',
  },
  {
    Section: 'Capital Account',
    GroupMatch: 'Capital Account (Company only)',
    LedgerKeywords: 'share capital',
    BusinessType: 'Company',
    H1: 'Liability',
    H2: 'Share Capital',
    H3: 'Equity - fully paid up',
    Notes: 'Company entities only',
  },
  {
    Section: 'Capital Account',
    GroupMatch: 'Capital Account (Company only)',
    LedgerKeywords: 'preference',
    BusinessType: 'Company',
    H1: 'Liability',
    H2: 'Share Capital',
    H3: 'Preference - fully paid up',
    Notes: 'Company entities only',
  },
  {
    Section: 'Capital Account',
    GroupMatch: 'Capital Account (Partnership/LLP only)',
    LedgerKeywords: '(all)',
    BusinessType: 'Partnership/LLP',
    H1: 'Liability',
    H2: "Partners' Capital Account",
    H3: "Partners' Capital Account",
    Notes: 'Partnership/LLP entities only',
  },
  {
    Section: 'Capital Account',
    GroupMatch: 'Capital Account (Other entities)',
    LedgerKeywords: '(all)',
    BusinessType: 'Other',
    H1: 'Liability',
    H2: "Owners' Capital Account",
    H3: "Owners' Capital Account",
    Notes: 'Individual/HUF/Sole Proprietorship',
  },
  {
    Section: 'Profit & Loss A/c Override',
    GroupMatch: 'Parent/Group = Primary',
    LedgerKeywords: 'profit | loss | profit & loss',
    BusinessType: 'Any',
    H1: 'Liability',
    H2: 'Reserves and Surplus',
    H3: 'Surplus in Statement of Profit and Loss',
    Notes: 'Overrides H1 to Liability',
  },
];

const h1Logic = [
  {
    Rule: 'Sales Accounts always Income',
    Condition: "Primary Group contains 'Sales Accounts'",
    Result: 'H1 = Income',
  },
  {
    Rule: 'Revenue accounts',
    Condition: 'Is Revenue = Yes and Balance < 0',
    Result: 'H1 = Expense',
  },
  {
    Rule: 'Revenue accounts',
    Condition: 'Is Revenue = Yes and Balance >= 0',
    Result: 'H1 = Income',
  },
  {
    Rule: 'Non-revenue accounts',
    Condition: 'Is Revenue = No and Balance < 0',
    Result: 'H1 = Asset',
  },
  {
    Rule: 'Non-revenue accounts',
    Condition: 'Is Revenue = No and Balance >= 0',
    Result: 'H1 = Liability',
  },
  {
    Rule: 'Balance selection',
    Condition: 'If Closing Balance == 0 use Opening Balance',
    Result: 'Balance used for H1 sign',
  },
];

const workbook = XLSX.utils.book_new();
const combined = [
  ...autoRules.map((rule, index) => ({
    Order: index + 1,
    Type: 'Auto',
    ...rule,
  })),
  ...h1Logic.map((rule, index) => ({
    Order: autoRules.length + index + 1,
    Type: 'H1 Logic',
    Section: 'H1 Logic',
    GroupMatch: '',
    LedgerKeywords: rule.Condition,
    BusinessType: '',
    H1: rule.Result,
    H2: '',
    H3: '',
    Notes: rule.Rule,
  })),
];

const autoSheet = XLSX.utils.json_to_sheet(combined);
XLSX.utils.book_append_sheet(workbook, autoSheet, 'All Rules');

const bsplPath = path.join(process.cwd(), 'src', 'data', 'bspl-heads.json');
const tallyPath = path.join(process.cwd(), 'src', 'data', 'tally-default-group-master.json');
const bsplRows = JSON.parse(fs.readFileSync(bsplPath, 'utf8'));
const tallyRows = JSON.parse(fs.readFileSync(tallyPath, 'utf8'));

const bsplSheet = XLSX.utils.json_to_sheet(bsplRows);
const tallySheet = XLSX.utils.json_to_sheet(tallyRows.map((value) => ({ Group: value })));
XLSX.utils.book_append_sheet(workbook, bsplSheet, 'BSPL Heads');
XLSX.utils.book_append_sheet(workbook, tallySheet, 'Tally Default Groups');

const outputPath = path.join(process.cwd(), 'classification_logics.xlsx');
const publicPath = path.join(process.cwd(), 'public', 'classification_logics.xlsx');
XLSX.writeFile(workbook, outputPath);
XLSX.writeFile(workbook, publicPath);

console.log(`Wrote ${outputPath}`);
console.log(`Wrote ${publicPath}`);
