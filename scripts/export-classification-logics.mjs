import fs from 'fs';
import path from 'path';
import XLSX from 'xlsx';

const autoRules = [
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'professional | service | services',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Sale of services',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'scrap',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Scrap sales',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'export',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Export incentives',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'grant',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Government grants',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'commission',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Commission income',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'rent | rental',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Rental Income',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'royalty',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Royalty income',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'know how',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Technical know how fees',
    Notes: 'Ledger keyword phrase match',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'insurance',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Insurance claims',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: 'misc',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Miscellaneous receipts',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Sales Accounts',
    GroupMatch: 'Sales Accounts',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Revenue from Operations',
    H3: 'Sale of products',
    Notes: 'Default',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Tax refunds',
    Notes: 'Also needs keywords: income tax | tax refund | tax',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Bank deposits',
    Notes: 'Also needs keywords: bank | fd | fixed deposit | fixeddeposit',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Non-current Investments',
    Notes: 'Also needs keywords: non-current investment',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Current Investments',
    Notes: 'Also needs keywords: current investment',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Advances and Deposits',
    Notes: 'Also needs keywords: advance | advances | deposit | deposits',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Interest income on Loans',
    Notes: 'Also needs keywords: loan | loans',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'dividend',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Dividend income on Non-current Investments',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'forex | foreign + gain | loss',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Gain on Foreign Exchange fluctuations (Net)',
    Notes: 'Requires both sets of keywords',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'sale + fixed asset | plant | property',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Gain on Foreign Exchange fluctuations (Net)',
    Notes: 'Requires both sale + asset keywords',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: 'written back | written off',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Provisions written back',
    Notes: 'Ledger keyword match (whole words)',
  },
  {
    Section: 'Direct/Indirect Incomes',
    GroupMatch: 'Direct Incomes | Indirect Incomes',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Income',
    H2: 'Other Income',
    H3: 'Miscellaneous non-operating Income',
    Notes: 'Default',
  },
  {
    Section: 'Purchase Accounts',
    GroupMatch: 'Purchase Accounts',
    LedgerKeywords: '',
    BusinessType: 'Trading',
    H1: 'Expense',
    H2: 'Purchases of Stock in Trade',
    H3: 'Purchases of Stock in Trade',
    Notes: '',
  },
  {
    Section: 'Purchase Accounts',
    GroupMatch: 'Purchase Accounts',
    LedgerKeywords: '',
    BusinessType: 'Non-Trading',
    H1: 'Expense',
    H2: 'Cost of Materials Consumed',
    H3: 'Purchase of Raw Materials',
    Notes: '',
  },
  {
    Section: 'Stock-in-Hand',
    GroupMatch: 'Stock-in-Hand',
    LedgerKeywords: '',
    BusinessType: 'Trading',
    H1: 'Expense',
    H2: 'Change in Inventories',
    H3: 'Change in Inventories',
    Notes: '',
  },
  {
    Section: 'Direct Expenses',
    GroupMatch: 'Direct Expenses (and not Indirect Expenses)',
    LedgerKeywords: '',
    BusinessType: 'Trading',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: '(keep current H3)',
    Notes: '',
  },
  {
    Section: 'Direct Expenses',
    GroupMatch: 'Direct Expenses (and not Indirect Expenses)',
    LedgerKeywords: '',
    BusinessType: 'Non-Trading',
    H1: 'Expense',
    H2: 'Cost of Materials Consumed',
    H3: 'Other Direct expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int + bank | loan | cash credit | cc | overdraft | od',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Interest expense on Borrowings',
    Notes: 'Requires interest + borrowing keywords',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int + gst | income tax | tds | tax',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Interest expense on late payment of taxes',
    Notes: 'Requires interest + tax keywords',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int + partner | capital | owner',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: "Interest on Partners' or Owners' Capital",
    Notes: 'Requires interest + partner/capital keywords',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'interest | int',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Interest expense others',
    Notes: 'Default interest',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bank charge | renewal charge | processing charge | bg commission',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Finance Costs',
    H3: 'Other Borrowing costs',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'amortisation | amortization | amorti',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Depreciation and Amortisation Expense',
    H3: 'Amortisation of Intangible Assets',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'depreciation | depn',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Depreciation and Amortisation Expense',
    H3: 'Depreciation on Property, Plant and Equipment',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'remuneration',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: "Partners' Remuneration",
    H3: "Partners' Remuneration",
    Notes: 'Only for Partnership / LLP',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'employee',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Salaries and wages',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'salary | salaries | wages | wage | stipend',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Salaries and wages',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'director + remuneration',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: "Directors' Remuneration",
    Notes: 'Only for Private/Public/OPC',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'esi',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Contribution to provident and other funds',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'pf | provident | esic | employee state | gratuity',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Employee Benefits Expense',
    H3: 'Contribution to provident and other funds',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'income tax | tax + current | current year',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Tax Expenses',
    H3: 'Income Tax - Current Year',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'deferred tax | deferred',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Tax Expenses',
    H3: 'Deferred Tax - Origination and reversal of Timing differences',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'mat',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Tax Expenses',
    H3: 'Income Tax - Less: MAT Credit Entitlement',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'adver | marketing',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Advertisement and Marketing',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'audit',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: "Auditor's Remuneration",
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bad debt | write off | written off',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Bad Debts written off',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bad loan | bad adva | bad adv',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Bad Loans and Advances written off',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'bank chg | bank charge',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Bank Charges',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'commission | brokerage',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Commission and Brokerage',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'stores | spares | parts',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Stores and spare parts - Purchase',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'conveyance | local travel',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Conveyance expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'csr | corporate social',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Corporate social responsibility expense',
    Notes: 'Only for Private/Public/OPC',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'design | product | development',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Design and product development',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'director sitting fees | director commission',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: "Directors' fees and commission",
    Notes: 'Only for Private/Public/OPC',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'donation | charity',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Donations and charity',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'electricity | power | fuel | diesel | petrol',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Electricity, Power and fuel',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'freight | carriage | forwarding | transport',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Freight and forwarding',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'information | technology | software',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Information technology services',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'insurance | life | health | key man',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Insurance expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'office | admin',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Office and Administration',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'print | stationery | stationary',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Printing and stationery',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'professional | consultancy | retainer',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Professional and consultancy charges',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision + debt',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Doubtful Debts',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision + loan | advance',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Doubtful Loans and Advances',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision + warran',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Warranties',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'provision',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Provision for Other Expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'rates | taxes | professional tax | ptax | trade licence | municipal tax | late fee',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Rates and Taxes',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'recruitment | training',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Recruitment and training charges',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'rent',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Rent expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'repair | r&m + building | office | factory',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Repairs to buildings',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'repair | r&m + plant | machinery | p&m',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Repairs to machinery',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'repair | r&m',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Repairs and maintenance',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'royalty',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Royalty expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'security | housekeeping',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Security and Housekeeping',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'selling | distribution',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Selling and Distribution expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'telephone | mobile | internet',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Telephone and Internet',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: 'travel',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Travelling expenses',
    Notes: '',
  },
  {
    Section: 'Indirect Expenses',
    GroupMatch: 'Indirect Expenses',
    LedgerKeywords: '(none matched)',
    BusinessType: 'Any',
    H1: 'Expense',
    H2: 'Other Expenses',
    H3: 'Miscellaneous other expenses',
    Notes: 'Default',
  },
];

const h1Logic = [
  {
    Rule: 'Sales Accounts always Income',
    Condition: "Primary Group contains 'Sales Accounts'",
    Result: 'H1 = Income',
  },
  {
    Rule: 'Revenue accounts',
    Condition: 'Is Revenue = Yes and Balance < 0',
    Result: 'H1 = Expense',
  },
  {
    Rule: 'Revenue accounts',
    Condition: 'Is Revenue = Yes and Balance >= 0',
    Result: 'H1 = Income',
  },
  {
    Rule: 'Non-revenue accounts',
    Condition: 'Is Revenue = No and Balance < 0',
    Result: 'H1 = Asset',
  },
  {
    Rule: 'Non-revenue accounts',
    Condition: 'Is Revenue = No and Balance >= 0',
    Result: 'H1 = Liability',
  },
  {
    Rule: 'Balance selection',
    Condition: 'If Closing Balance == 0 use Opening Balance',
    Result: 'Balance used for H1 sign',
  },
];

const workbook = XLSX.utils.book_new();
const combined = [
  ...autoRules.map((rule, index) => ({
    Order: index + 1,
    Type: 'Auto',
    ...rule,
  })),
  ...h1Logic.map((rule, index) => ({
    Order: autoRules.length + index + 1,
    Type: 'H1 Logic',
    Section: 'H1 Logic',
    GroupMatch: '',
    LedgerKeywords: rule.Condition,
    BusinessType: '',
    H1: rule.Result,
    H2: '',
    H3: '',
    Notes: rule.Rule,
  })),
];

const autoSheet = XLSX.utils.json_to_sheet(combined);
XLSX.utils.book_append_sheet(workbook, autoSheet, 'All Rules');

const bsplPath = path.join(process.cwd(), 'src', 'data', 'bspl-heads.json');
const tallyPath = path.join(process.cwd(), 'src', 'data', 'tally-default-group-master.json');
const bsplRows = JSON.parse(fs.readFileSync(bsplPath, 'utf8'));
const tallyRows = JSON.parse(fs.readFileSync(tallyPath, 'utf8'));

const bsplSheet = XLSX.utils.json_to_sheet(bsplRows);
const tallySheet = XLSX.utils.json_to_sheet(tallyRows.map((value) => ({ Group: value })));
XLSX.utils.book_append_sheet(workbook, bsplSheet, 'BSPL Heads');
XLSX.utils.book_append_sheet(workbook, tallySheet, 'Tally Default Groups');

const outputPath = path.join(process.cwd(), 'classification_logics.xlsx');
const publicPath = path.join(process.cwd(), 'public', 'classification_logics.xlsx');
XLSX.writeFile(workbook, outputPath);
XLSX.writeFile(workbook, publicPath);

console.log(`Wrote ${outputPath}`);
console.log(`Wrote ${publicPath}`);
